    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.11.5/js/dataTables.bootstrap5.min.js"></script>
    <script>
        // Enable tooltips
        var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
        var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
            return new bootstrap.Tooltip(tooltipTriggerEl);
        });

        // Initialize DataTable
        $(document).ready(function() {
            const membersTable = $('#membersTable').DataTable({
                ajax: {
                    url: '/api/members',
                    dataSrc: ''
                },
                columns: [
                    { 
                        data: '_id',
                        visible: false
                    },
                    { 
                        data: 'fullName',
                        render: function(data, type, row) {
                            return `
                                <div class="d-flex align-items-center">
                                    <img src="${row.photo || 'https://ui-avatars.com/api/?name=' + encodeURIComponent(row.fullName) + '&background=random'}" 
                                         class="member-photo me-2" 
                                         alt="${row.fullName}">
                                    <div>
                                        <div class="fw-bold">${data}</div>
                                        <small class="text-muted">${row.email}</small>
                                    </div>
                                </div>
                            `;
                        }
                    },
                    { 
                        data: 'idNumber',
                        className: 'align-middle'
                    },
                    { 
                        data: 'activity',
                        className: 'align-middle'
                    },
                    {
                        data: 'status',
                        className: 'align-middle',
                        render: function(data) {
                            const statusClass = {
                                'active': 'success',
                                'inactive': 'secondary',
                                'suspended': 'danger'
                            }[data] || 'secondary';
                            
                            return `<span class="badge bg-${statusClass}">${data.charAt(0).toUpperCase() + data.slice(1)}</span>`;
                        }
                    },
                    {
                        data: '_id',
                        className: 'text-end align-middle',
                        orderable: false,
                        render: function(data, type, row) {
                            return `
                                <div class="btn-group btn-group-sm">
                                    <button class="btn btn-outline-primary view-member" data-id="${data}" data-bs-toggle="tooltip" title="View">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                    <button class="btn btn-outline-secondary edit-member" data-id="${data}" data-bs-toggle="tooltip" title="Edit">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="btn btn-outline-danger delete-member" data-id="${data}" data-bs-toggle="tooltip" title="Delete">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            `;
                        }
                    }
                ],
                order: [[1, 'asc']],
                responsive: true
            });

            // Update stats
            function updateStats() {
                $.get('/api/members', function(members) {
                    const totalMembers = members.length;
                    const activeMembers = members.filter(m => m.status === 'active').length;
                    const thisMonth = new Date();
                    thisMonth.setDate(1);
                    thisMonth.setHours(0, 0, 0, 0);
                    
                    const newThisMonth = members.filter(m => new Date(m.createdAt) >= thisMonth).length;
                    
                    $('#totalMembers').text(totalMembers);
                    $('#activeMembers').text(activeMembers);
                    $('#newMembers').text(newThisMonth);
                });
            }

            // Initial stats update
            updateStats();

            // View member details
            $(document).on('click', '.view-member', function() {
                const memberId = $(this).data('id');
                $.get(`/api/members/${memberId}`, function(member) {
                    const memberDetails = `
                        <div class="row">
                            <div class="col-md-4 text-center">
                                <img src="${member.photo || 'https://ui-avatars.com/api/?name=' + encodeURIComponent(member.fullName) + '&size=200'}" 
                                     class="img-fluid rounded mb-3" 
                                     alt="${member.fullName}">
                                <h4>${member.fullName}</h4>
                                <p class="text-muted">${member.idNumber}</p>
                                <div class="mt-3">
                                    <span class="badge bg-${member.status === 'active' ? 'success' : 'secondary'}">
                                        ${member.status.charAt(0).toUpperCase() + member.status.slice(1)}
                                    </span>
                                </div>
                            </div>
                            <div class="col-md-8">
                                <div class="table-responsive">
                                    <table class="table table-sm">
                                        <tr>
                                            <th>Date of Birth:</th>
                                            <td>${new Date(member.birthDate).toLocaleDateString()}</td>
                                        </tr>
                                        <tr>
                                            <th>Place of Birth:</th>
                                            <td>${member.birthPlace}</td>
                                        </tr>
                                        <tr>
                                            <th>Activity:</th>
                                            <td>${member.activity}</td>
                                        </tr>
                                        <tr>
                                            <th>Email:</th>
                                            <td>${member.email}</td>
                                        </tr>
                                        <tr>
                                            <th>Phone:</th>
                                            <td>${member.phone}</td>
                                        </tr>
                                        <tr>
                                            <th>Issued On:</th>
                                            <td>${new Date(member.issuedAt).toLocaleDateString()}</td>
                                        </tr>
                                    </table>
                                </div>
                                <div class="text-center mt-3">
                                    <img src="${member.qrCode}" alt="QR Code" class="img-fluid" style="max-width: 150px;">
                                    <p class="text-muted mt-2">Member QR Code</p>
                                </div>
                            </div>
                        </div>
                    `;
                    
                    $('#memberDetails').html(memberDetails);
                    $('#viewMemberModal').modal('show');
                });
            });

            // Delete member
            $(document).on('click', '.delete-member', function() {
                const memberId = $(this).data('id');
                
                if (confirm('Are you sure you want to delete this member? This action cannot be undone.')) {
                    $.ajax({
                        url: `/api/members/${memberId}`,
                        type: 'DELETE',
                        success: function() {
                            membersTable.ajax.reload();
                            updateStats();
                            alert('Member deleted successfully');
                        },
                        error: function() {
                            alert('Error deleting member');
                        }
                    });
                }
            });

            // Download card
            $('#downloadCardBtn').on('click', function() {
                const memberId = $('.view-member').data('id');
                // Implement card download functionality
                alert('Card download functionality will be implemented here');
            });
        });
    </script>
</body>
</html>
